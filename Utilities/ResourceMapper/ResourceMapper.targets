<?xml version="1.0" encoding="utf-8" ?>
<Project ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!--<ItemGroup Condition="'$(BuildingInsideVisualStudio)'=='true'">
    <AvailableItemName Include="ResourcePackerResource" />
  </ItemGroup>-->
  <UsingTask TaskName="ResourceMapper.ResourceMapperTask" TaskFactory="CodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v12.0.dll"  >
    <ParameterGroup>
      <TaskAssemblyPath ParameterType="System.String" Required="true" />
      <RootDirectory ParameterType="System.String" Required="true" />
      <InputFiles ParameterType="System.String[]" Required="true" />
      <OutputFile ParameterType="System.String" Required="true" />
      <Namespace ParameterType="System.String" />
      <TopClassName ParameterType="System.String" />
    </ParameterGroup>
    <Task>
      <Reference Include="Microsoft.Build.Framework" />
      <Reference Include="Microsoft.CSharp" />
      <Reference Include="System.Xml" />
      <Code Type="Class" Language="cs" Source="$(MSBuildThisFileDirectory)\ResourceMapperTask.cs"/>
    </Task>
  </UsingTask>
  <PropertyGroup>
    <!--<CompileDependsOn>
      ResourceMapper;
      $(CompileDependsOn)
    </CompileDependsOn>-->
    <ResourceMapperInputFiles Condition="'$(ResourceMapperInputFiles)' == ''">@(EmbeddedResource)</ResourceMapperInputFiles>
    <ResourceMapperRootDirectory Condition="'$(ResourceMapperRootDirectory)' == ''">$(MSBuildProjectDirectory)</ResourceMapperRootDirectory>
    <ResourceMapperNamespace Condition="'$(ResourceMapperNamespace)' == ''">$(MSBuildProjectName)</ResourceMapperNamespace>
    <ResourceMapperOutputFile Condition="'$(ResourceMapperOutputFile)' == ''">$(MSBuildProjectDirectory)\Generated\ResourceMap.cs</ResourceMapperOutputFile>
  </PropertyGroup>
  <!--<PropertyGroup>
    <Compile>ResourceMapper</Compile>
  </PropertyGroup>-->
  <Target Name="ResourceMapper" BeforeTargets="BeforeBuild">
    <Message Text=" ResourceMapper task started" Importance="high" />
    <ResourceMapper.ResourceMapperTask
      TaskAssemblyPath="$(MSBuildThisFileDirectory)\bin\$(Configuration)\net46\" 
      InputFiles="$(ResourceMapperInputFiles)"
      RootDirectory="$(ResourceMapperRootDirectory)" 
      Namespace="$(ResourceMapperNamespace)" 
      OutputFile="$(ResourceMapperOutputFile)"
      TopClassName="$(ResourceMapperTopClassName)"/>
  </Target>
</Project>
